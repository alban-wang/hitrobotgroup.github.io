var NAV2D=NAV2D||{REVISION:"0.3.0"},action="goal";
NAV2D.ImageMapClientNav=function(a){var c=this;a=a||{};this.ros=a.ros;var d=a.topic||"/map_metadata",g=a.image;this.serverName=a.serverName||"/move_base";this.actionName=a.actionName||"move_base_msgs/MoveBaseAction";this.rootObject=a.rootObject||new createjs.Container;this.viewer=a.viewer;this.withOrientation=a.withOrientation||!1;this.navigator=null;var b=new ROS2D.ImageMapClient({ros:this.ros,rootObject:this.rootObject,topic:d,image:g});b.on("change",function(){c.navigator=new NAV2D.Navigator({ros:c.ros,
serverName:c.serverName,actionName:c.actionName,rootObject:c.rootObject,withOrientation:c.withOrientation});c.viewer.scaleToDimensions(b.currentImage.width,b.currentImage.height);c.viewer.shift(b.currentImage.pose.position.x,b.currentImage.pose.position.y)})};
NAV2D.Navigator=function(a){function c(a){var c=new ROSLIB.Goal({actionClient:k,goalMessage:{target_pose:{header:{frame_id:"/map"},pose:a}}}),b=new ROS2D.NavigationArrow({size:15,strokeSize:1,fillColor:createjs.Graphics.getRGB(255,64,128,.66),pulse:!0});b.x=a.position.x;b.y=-a.position.y;b.rotation=e.rosQuaternionToGlobalTheta(a.orientation);b.scaleX=1/e.scaleX;b.scaleY=1/e.scaleY;d.rootObject.addChild(b);c.on("result",function(){d.rootObject.removeChild(b)})}var d=this;a=a||{};var g=a.ros,b=a.serverName||
"/move_base",l=a.actionName||"move_base_msgs/MoveBaseAction",m=a.withOrientation||!1;this.rootObject=a.rootObject||new createjs.Container;var k=new ROSLIB.ActionClient({ros:g,actionName:l,serverName:b}),e;e=d.rootObject instanceof createjs.Stage?d.rootObject:d.rootObject.getStage();var f=new ROS2D.NavigationArrow({size:25,strokeSize:1,fillColor:createjs.Graphics.getRGB(255,128,0,.66),pulse:!0});f.visible=!1;this.rootObject.addChild(f);var h=!1;(new ROSLIB.Topic({ros:g,name:"/robot_pose",messageType:"geometry_msgs/Pose",
throttle_rate:100})).subscribe(function(a){f.x=a.position.x;f.y=-a.position.y;h||(f.scaleX=1/e.scaleX,f.scaleY=1/e.scaleY,h=!0);f.rotation=e.rosQuaternionToGlobalTheta(a.orientation);f.visible=!0});!1===m?this.rootObject.addEventListener("dblclick",function(a){a=e.globalToRos(a.stageX,a.stageY);var b=new ROSLIB.Pose({position:new ROSLIB.Vector3(a)});"goal"==action?c(b):"pose"==action&&(a=new ROSLIB.Topic({ros:g,name:"/initialpose",messageType:"geometry_msgs/PoseWithCovarianceStamped"}),b=new ROSLIB.Message({header:{frame_id:"/map"},
pose:{pose:b}}),a.publish(b))}):(this.rootObject.addEventListener("stagemousedown",function(a){}),this.rootObject.addEventListener("stagemousemove",function(a){}),this.rootObject.addEventListener("stagemouseup",function(a){}))};
NAV2D.OccupancyGridClientNav=function(a){var c=this;a=a||{};this.ros=a.ros;var d=a.topic||"/map",g=a.continuous;this.serverName=a.serverName||"/move_base";this.actionName=a.actionName||"move_base_msgs/MoveBaseAction";this.rootObject=a.rootObject||new createjs.Container;this.viewer=a.viewer;this.withOrientation=a.withOrientation||!1;this.navigator=null;var b=new ROS2D.OccupancyGridClient({ros:this.ros,rootObject:this.rootObject,continuous:g,topic:d});b.on("change",function(){c.navigator=new NAV2D.Navigator({ros:c.ros,
serverName:c.serverName,actionName:c.actionName,rootObject:c.rootObject,withOrientation:c.withOrientation});c.viewer.scaleToDimensions(b.currentGrid.width,b.currentGrid.height);c.viewer.shift(b.currentGrid.pose.position.x,b.currentGrid.pose.position.y)})};